---
- name: installation serveur bdd
  hosts: all
  become: yes
  
  tasks: 
    - name: install mariadb-server 
      apt:  mariadb-server
    - name: install python3-pymysql 
      apt:  python3-pymysql
    - name: install php 
      apt:  php 
    - name: start up the mariadb service 
      ansible.builtin.shell: "systemctl start mariadb"  
    - name: ensure mariadb is enabled to run on startup  
      ansible.builtin.service: 
        name: mariadb 
        state: started 
        enabled: yes
    - name: Set the root password
      mysql_user:
        name: root
        password: "{{mysql_root_pass}}"
        login_unix_socket: /var/run/mysqld/mysqld.sock
        
  
# Ce playbook va installer un SGBD et PhpMyAdmin sur la machine hôte.
# Pour ce faire il va :
# - Installer mariaDB, PIP & php
# - Active le serveur mariaDB dans la liste des services
# - Installer et configurer les modules php ncessaire à la mise en service de PhpMyAdmin
# - Installer phpMyAdmin
